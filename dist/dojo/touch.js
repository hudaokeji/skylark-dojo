/**
 * dojo - A version of dojo.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dojo/
 * @license MIT
 */
define(["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(e,t,o,a,n,c,u,r,i,d){var s,g,l,h,f,m,v,p,b,T,y=u("ios")<5,j=u("pointer-events")||u("MSPointer"),w=function(){var e={};for(var t in{down:1,move:1,up:1,cancel:1,over:1,out:1})e[t]=u("MSPointer")?"MSPointer"+t.charAt(0).toUpperCase()+t.slice(1):"pointer"+t;return e}(),X=u("touch-events"),D=!1;function Y(e,t,o){return j&&o?function(e,t){return c(e,o,t)}:X?function(o,a){var n=c(o,t,function(e){a.call(this,e),b=(new Date).getTime()}),u=c(o,e,function(e){(!b||(new Date).getTime()>b+1e3)&&a.call(this,e)});return{remove:function(){n.remove(),u.remove()}}}:function(t,o){return c(t,e,o)}}function O(e,t,n){var u=function(e){do{if(void 0!==e.dojoClick)return e}while(e=e.parentNode)}(e.target);if((g=!e.target.disabled&&u&&u.dojoClick)&&(l=(D="useTarget"==g)?u:e.target,D&&e.preventDefault(),h=e.changedTouches?e.changedTouches[0].pageX-d.global.pageXOffset:e.clientX,f=e.changedTouches?e.changedTouches[0].pageY-d.global.pageYOffset:e.clientY,m=("object"==typeof g?g.x:"number"==typeof g?g:0)||4,v=("object"==typeof g?g.y:"number"==typeof g?g:0)||4,!s)){function r(e){g=D?o.isDescendant(d.doc.elementFromPoint(e.changedTouches?e.changedTouches[0].pageX-d.global.pageXOffset:e.clientX,e.changedTouches?e.changedTouches[0].pageY-d.global.pageYOffset:e.clientY),l):g&&(e.changedTouches?e.changedTouches[0].target:e.target)==l&&Math.abs((e.changedTouches?e.changedTouches[0].pageX-d.global.pageXOffset:e.clientX)-h)<=m&&Math.abs((e.changedTouches?e.changedTouches[0].pageY-d.global.pageYOffset:e.clientY)-f)<=v}function i(e){d.doc.addEventListener(e,function(t){t._dojo_click||!((new Date).getTime()<=p+1e3)||"INPUT"==t.target.tagName&&a.contains(t.target,"dijitOffScreen")||(t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),"click"!=e||"INPUT"==t.target.tagName&&"radio"!=t.target.type&&"checkbox"!=t.target.type||"TEXTAREA"==t.target.tagName||"AUDIO"==t.target.tagName||"VIDEO"==t.target.tagName||t.preventDefault())},!0)}s=!0,d.doc.addEventListener(t,function(e){r(e),D&&e.preventDefault()},!0),d.doc.addEventListener(n,function(e){if(r(e),g){p=(new Date).getTime();var t=D?l:e.target;"LABEL"===t.tagName&&(t=o.byId(t.getAttribute("for"))||t);var a=e.changedTouches?e.changedTouches[0]:e,n=document.createEvent("MouseEvents");n._dojo_click=!0,n.initMouseEvent("click",!0,!0,e.view,e.detail,a.screenX,a.screenY,a.clientX,a.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),setTimeout(function(){c.emit(t,"click",n),p=(new Date).getTime()},0)}},!0),i("click"),i("mousedown"),i("mouseup")}}j?i(function(){d.doc.addEventListener(w.down,function(e){O(e,w.move,w.up)},!0)}):X&&i(function(){function e(e){var t=n.delegate(e,{bubbles:!0});return u("ios")>=6&&(t.touches=e.touches,t.altKey=e.altKey,t.changedTouches=e.changedTouches,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.targetTouches=e.targetTouches),t}T=d.body(),d.doc.addEventListener("touchstart",function(e){b=(new Date).getTime();var t=T;T=e.target,c.emit(t,"dojotouchout",{relatedTarget:T,bubbles:!0}),c.emit(T,"dojotouchover",{relatedTarget:t,bubbles:!0}),O(e,"touchmove","touchend")},!0),c(d.doc,"touchmove",function(t){b=(new Date).getTime();var o=d.doc.elementFromPoint(t.pageX-(y?0:d.global.pageXOffset),t.pageY-(y?0:d.global.pageYOffset));o&&(T!==o&&(c.emit(T,"dojotouchout",{relatedTarget:o,bubbles:!0}),c.emit(o,"dojotouchover",{relatedTarget:T,bubbles:!0}),T=o),c.emit(o,"dojotouchmove",e(t))||t.preventDefault())}),c(d.doc,"touchend",function(t){b=(new Date).getTime();var o=d.doc.elementFromPoint(t.pageX-(y?0:d.global.pageXOffset),t.pageY-(y?0:d.global.pageYOffset))||d.body();c.emit(o,"dojotouchend",e(t))})});var E={press:Y("mousedown","touchstart",w.down),move:Y("mousemove","dojotouchmove",w.move),release:Y("mouseup","dojotouchend",w.up),cancel:Y(r.leave,"touchcancel",j?w.cancel:null),over:Y("mouseover","dojotouchover",w.over),out:Y("mouseout","dojotouchout",w.out),enter:r._eventHandler(Y("mouseover","dojotouchover",w.over)),leave:r._eventHandler(Y("mouseout","dojotouchout",w.out))};return u("extend-dojo")&&(e.touch=E),E});
//# sourceMappingURL=sourcemaps/touch.js.map
