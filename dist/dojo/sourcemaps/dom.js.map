{"version":3,"sources":["dom.js"],"names":["define","has","win","document","execCommand","e","dom","byId","id","doc","_d","te","getElementById","attributes","value","eles","all","nodeName","i","isDescendant","node","ancestor","parentNode","add","global","element","style","prefixes","length","name","cssUserSelect","setSelectable","selectable","nodes","getElementsByTagName","removeAttribute","setAttribute"],"mappings":";;;;;;;AAAAA,QAAQ,UAAW,kBACjB,SAASC,EAAKC,GAMf,GAAGD,EAAI,OAAS,EACf,IACCE,SAASC,YAAY,wBAAwB,GAAO,GACpD,MAAMC,IAUR,IAAIC,KAKDL,EAAI,MACNK,EAAIC,KAAO,SAASC,EAAIC,GACvB,GAAgB,iBAAND,EACT,OAAOA,EAER,IAAIE,EAAKD,GAAOP,EAAIO,IAAKE,EAAKH,GAAME,EAAGE,eAAeJ,GAGtD,GAAGG,IAAOA,EAAGE,WAAWL,GAAGM,OAASN,GAAMG,EAAGH,IAAMA,GAClD,OAAOG,EAEP,IAAII,EAAOL,EAAGM,IAAIR,GACdO,IAAQA,EAAKE,WAChBF,GAAQA,IAIT,IADA,IAAIG,EAAI,EACDP,EAAKI,EAAKG,MAChB,GAAIP,EAAGE,YAAcF,EAAGE,WAAWL,IAAMG,EAAGE,WAAWL,GAAGM,OAASN,GAAOG,EAAGH,IAAMA,EAClF,OAAOG,GAMXL,EAAIC,KAAO,SAASC,EAAIC,GAGvB,OAAsB,iBAAND,GAAmBC,GAAOP,EAAIO,KAAKG,eAAeJ,GAAMA,IAAO,MAyCjFF,EAAIa,aAAe,SAA4BC,EAAyBC,GAcvE,IAGC,IAFAD,EAAOd,EAAIC,KAAKa,GAChBC,EAAWf,EAAIC,KAAKc,GACdD,GAAK,CACV,GAAGA,GAAQC,EACV,OAAO,EAERD,EAAOA,EAAKE,YAEb,MAAMjB,IACP,OAAO,GAaRJ,EAAIsB,IAAI,kBAAmB,SAASC,EAAQf,EAAKgB,GAEhD,IAAIA,EAAU,OAAO,EAErB,IAAIC,EAAQD,EAAQC,MAChBC,GAAY,QAAS,IAAK,MAAO,UACpCT,EAAIS,EAASC,OACbC,EAAO,aAIR,GACC,QAA0B,IAAhBH,EAAMG,GAEf,OAAOA,QAEFX,MAAQW,EAAOF,EAAST,GAAK,eAGpC,OAAO,IAyBR,IAAIY,EAAgB7B,EAAI,mBAyBxB,OAxBAK,EAAIyB,cAAgBD,EAAgB,SAASV,EAAMY,GAElD1B,EAAIC,KAAKa,GAAMM,MAAMI,GAAiBE,EAAa,GAAK,QACrD,SAASZ,EAAMY,GAKlB,IAAIC,GAJJb,EAAOd,EAAIC,KAAKa,IAICc,qBAAqB,KACrChB,EAAIe,EAAML,OAEX,GAAGI,EAEF,IADAZ,EAAKe,gBAAgB,gBACfjB,KACLe,EAAMf,GAAGiB,gBAAgB,qBAI1B,IADAf,EAAKgB,aAAa,eAAgB,MAC5BlB,KACLe,EAAMf,GAAGkB,aAAa,eAAgB,OAKlC9B","file":"../dom.js","sourcesContent":["define([\"./sniff\", \"./_base/window\"],\r\n\t\tfunction(has, win){\r\n\t// module:\r\n\t//\t\tdojo/dom\r\n\r\n\t// FIXME: need to add unit tests for all the semi-public methods\r\n\r\n\tif(has(\"ie\") <= 7){\r\n\t\ttry{\r\n\t\t\tdocument.execCommand(\"BackgroundImageCache\", false, true);\r\n\t\t}catch(e){\r\n\t\t\t// sane browsers don't have cache \"issues\"\r\n\t\t}\r\n\t}\r\n\r\n\t// =============================\r\n\t// DOM Functions\r\n\t// =============================\r\n\r\n\t// the result object\r\n\tvar dom = {\r\n\t\t// summary:\r\n\t\t//\t\tThis module defines the core dojo DOM API.\r\n\t};\r\n\r\n\tif(has(\"ie\")){\r\n\t\tdom.byId = function(id, doc){\r\n\t\t\tif(typeof id != \"string\"){\r\n\t\t\t\treturn id;\r\n\t\t\t}\r\n\t\t\tvar _d = doc || win.doc, te = id && _d.getElementById(id);\r\n\t\t\t// attributes.id.value is better than just id in case the\r\n\t\t\t// user has a name=id inside a form\r\n\t\t\tif(te && (te.attributes.id.value == id || te.id == id)){\r\n\t\t\t\treturn te;\r\n\t\t\t}else{\r\n\t\t\t\tvar eles = _d.all[id];\r\n\t\t\t\tif(!eles || eles.nodeName){\r\n\t\t\t\t\teles = [eles];\r\n\t\t\t\t}\r\n\t\t\t\t// if more than 1, choose first with the correct id\r\n\t\t\t\tvar i = 0;\r\n\t\t\t\twhile((te = eles[i++])){\r\n\t\t\t\t\tif((te.attributes && te.attributes.id && te.attributes.id.value == id) || te.id == id){\r\n\t\t\t\t\t\treturn te;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}else{\r\n\t\tdom.byId = function(id, doc){\r\n\t\t\t// inline'd type check.\r\n\t\t\t// be sure to return null per documentation, to match IE branch.\r\n\t\t\treturn ((typeof id == \"string\") ? (doc || win.doc).getElementById(id) : id) || null; // DOMNode\r\n\t\t};\r\n\t}\r\n\t/*=====\r\n\t dom.byId = function(id, doc){\r\n\t\t// summary:\r\n\t\t//\t\tReturns DOM node with matching `id` attribute or falsy value (ex: null or undefined)\r\n\t\t//\t\tif not found.  If `id` is a DomNode, this function is a no-op.\r\n\t\t//\r\n\t\t// id: String|DOMNode\r\n\t\t//\t\tA string to match an HTML id attribute or a reference to a DOM Node\r\n\t\t//\r\n\t\t// doc: Document?\r\n\t\t//\t\tDocument to work in. Defaults to the current value of\r\n\t\t//\t\tdojo/_base/window.doc.  Can be used to retrieve\r\n\t\t//\t\tnode references from other documents.\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tLook up a node by ID:\r\n\t\t//\t|\trequire([\"dojo/dom\"], function(dom){\r\n\t\t//\t|\t\tvar n = dom.byId(\"foo\");\r\n\t\t//\t|\t});\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tCheck if a node exists, and use it.\r\n\t\t//\t|\trequire([\"dojo/dom\"], function(dom){\r\n\t\t//\t|\t\tvar n = dom.byId(\"bar\");\r\n\t\t//\t|\t\tif(n){ doStuff() ... }\r\n\t\t//\t|\t});\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tAllow string or DomNode references to be passed to a custom function:\r\n\t\t//\t|\trequire([\"dojo/dom\"], function(dom){\r\n\t\t//\t|\t\tvar foo = function(nodeOrId){\r\n\t\t//\t|\t\t\tnodeOrId = dom.byId(nodeOrId);\r\n\t\t//\t|\t\t\t// ... more stuff\r\n\t\t//\t|\t\t}\r\n\t\t//\t|\t});\r\n\t };\r\n\t =====*/\r\n\r\n\tdom.isDescendant = function(/*DOMNode|String*/ node, /*DOMNode|String*/ ancestor){\r\n\t\t// summary:\r\n\t\t//\t\tReturns true if node is a descendant of ancestor\r\n\t\t// node: DOMNode|String\r\n\t\t//\t\tstring id or node reference to test\r\n\t\t// ancestor: DOMNode|String\r\n\t\t//\t\tstring id or node reference of potential parent to test against\r\n\t\t//\r\n\t\t// example:\r\n\t\t//\t\tTest is node id=\"bar\" is a descendant of node id=\"foo\"\r\n\t\t//\t|\trequire([\"dojo/dom\"], function(dom){\r\n\t\t//\t|\t\tif(dom.isDescendant(\"bar\", \"foo\")){ ... }\r\n\t\t//\t|\t});\r\n\r\n\t\ttry{\r\n\t\t\tnode = dom.byId(node);\r\n\t\t\tancestor = dom.byId(ancestor);\r\n\t\t\twhile(node){\r\n\t\t\t\tif(node == ancestor){\r\n\t\t\t\t\treturn true; // Boolean\r\n\t\t\t\t}\r\n\t\t\t\tnode = node.parentNode;\r\n\t\t\t}\r\n\t\t}catch(e){ /* squelch, return false */ }\r\n\t\treturn false; // Boolean\r\n\t};\r\n\r\n\r\n\t// TODO: do we need setSelectable in the base?\r\n\r\n\t// Add feature test for user-select CSS property\r\n\t// (currently known to work in all but IE < 10 and Opera)\r\n\t// TODO: The user-select CSS property as of May 2014 is no longer part of\r\n\t// any CSS specification. In IE, -ms-user-select does not do the same thing\r\n\t// as the unselectable attribute on elements; namely, dijit Editor buttons\r\n\t// do not properly prevent the content of the editable content frame from\r\n\t// unblurring. As a result, the -ms- prefixed version is omitted here.\r\n\thas.add(\"css-user-select\", function(global, doc, element){\r\n\t\t// Avoid exception when dom.js is loaded in non-browser environments\r\n\t\tif(!element){ return false; }\r\n\t\t\r\n\t\tvar style = element.style;\r\n\t\tvar prefixes = [\"Khtml\", \"O\", \"Moz\", \"Webkit\"],\r\n\t\t\ti = prefixes.length,\r\n\t\t\tname = \"userSelect\",\r\n\t\t\tprefix;\r\n\r\n\t\t// Iterate prefixes from most to least likely\r\n\t\tdo{\r\n\t\t\tif(typeof style[name] !== \"undefined\"){\r\n\t\t\t\t// Supported; return property name\r\n\t\t\t\treturn name;\r\n\t\t\t}\r\n\t\t}while(i-- && (name = prefixes[i] + \"UserSelect\"));\r\n\r\n\t\t// Not supported if we didn't return before now\r\n\t\treturn false;\r\n\t});\r\n\r\n\t/*=====\r\n\tdom.setSelectable = function(node, selectable){\r\n\t\t// summary:\r\n\t\t//\t\tEnable or disable selection on a node\r\n\t\t// node: DOMNode|String\r\n\t\t//\t\tid or reference to node\r\n\t\t// selectable: Boolean\r\n\t\t//\t\tstate to put the node in. false indicates unselectable, true\r\n\t\t//\t\tallows selection.\r\n\t\t// example:\r\n\t\t//\t\tMake the node id=\"bar\" unselectable\r\n\t\t//\t|\trequire([\"dojo/dom\"], function(dom){\r\n\t\t//\t|\t\tdom.setSelectable(\"bar\");\r\n\t\t//\t|\t});\r\n\t\t// example:\r\n\t\t//\t\tMake the node id=\"bar\" selectable\r\n\t\t//\t|\trequire([\"dojo/dom\"], function(dom){\r\n\t\t//\t|\t\tdom.setSelectable(\"bar\", true);\r\n\t\t//\t|\t});\r\n\t};\r\n\t=====*/\r\n\r\n\tvar cssUserSelect = has(\"css-user-select\");\r\n\tdom.setSelectable = cssUserSelect ? function(node, selectable){\r\n\t\t// css-user-select returns a (possibly vendor-prefixed) CSS property name\r\n\t\tdom.byId(node).style[cssUserSelect] = selectable ? \"\" : \"none\";\r\n\t} : function(node, selectable){\r\n\t\tnode = dom.byId(node);\r\n\r\n\t\t// (IE < 10 / Opera) Fall back to setting/removing the\r\n\t\t// unselectable attribute on the element and all its children\r\n\t\tvar nodes = node.getElementsByTagName(\"*\"),\r\n\t\t\ti = nodes.length;\r\n\r\n\t\tif(selectable){\r\n\t\t\tnode.removeAttribute(\"unselectable\");\r\n\t\t\twhile(i--){\r\n\t\t\t\tnodes[i].removeAttribute(\"unselectable\");\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tnode.setAttribute(\"unselectable\", \"on\");\r\n\t\t\twhile(i--){\r\n\t\t\t\tnodes[i].setAttribute(\"unselectable\", \"on\");\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\treturn dom;\r\n});\r\n"]}