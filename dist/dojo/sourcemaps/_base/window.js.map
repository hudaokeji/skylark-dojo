{"version":3,"sources":["_base/window.js"],"names":["define","dojo","lang","has","ret","global","doc","body","getElementsByTagName","setContext","globalObject","globalDocument","withGlobal","callback","thisObject","cbArguments","oldGlob","withDoc","call","document","documentObject","isIE","mode","pwin","oldDoc","oldQ","oldIE","isQuirks","add","compatMode","parentWindow","navigator","parseFloat","appVersion","split","undefined","documentMode","Math","floor","apply","mixin"],"mappings":";;;;;;;AAAAA,QAAQ,WAAY,SAAU,YAAa,SAASC,EAAMC,EAAMC,GAIhE,IAAIC,GAIHC,OAAQJ,EAAKI,OAYbC,IAAKL,EAAKI,OAAiB,UAAK,KAchCE,KAAM,SAAuBD,GAS5B,OADAA,EAAMA,GAAOL,EAAKK,KACPC,MAAQD,EAAIE,qBAAqB,QAAQ,IAGrDC,WAAY,SAAoBC,EAAkCC,GAOjEV,EAAKI,OAASD,EAAIC,OAASK,EAC3BT,EAAKK,IAAMF,EAAIE,IAAMK,GAGtBC,WAAY,SAAqBF,EACdG,EACDC,EACDC,GAWhB,IAAIC,EAAUf,EAAKI,OACnB,IAEC,OADAJ,EAAKI,OAASD,EAAIC,OAASK,EACpBN,EAAIa,QAAQC,KAAK,KAAMR,EAAaS,SAAUN,EAAUC,EAAYC,GAC3E,QACAd,EAAKI,OAASD,EAAIC,OAASW,IAI7BC,QAAS,SAA8BG,EACrBP,EACDC,EACDC,GASf,IAEoBM,EAAMC,EAAMC,EAF5BC,EAASpB,EAAIE,IAChBmB,EAAOtB,EAAI,UACXuB,EAAQvB,EAAI,MAEb,IAwBC,OAvBAF,EAAKK,IAAMF,EAAIE,IAAMc,EAGrBnB,EAAK0B,SAAWxB,EAAIyB,IAAI,SAAiC,cAAvB3B,EAAKK,IAAIuB,YAA4B,GAAM,GAE1E1B,EAAI,QACFoB,EAAOH,EAAeU,eAAiBP,EAAKQ,YAI/CV,EAAOW,WAAWT,EAAKQ,UAAUE,WAAWC,MAAM,SAAS,UAAOC,GAClEb,EAAOF,EAAegB,eACH,GAARd,GAAae,KAAKC,MAAMjB,IAASC,IAC3CD,EAAOC,GAERrB,EAAKoB,KAAOlB,EAAIyB,IAAI,KAAMP,GAAM,GAAM,IAIrCP,GAAiC,iBAAZD,IACvBA,EAAWC,EAAWD,IAGhBA,EAAS0B,MAAMzB,EAAYC,OAClC,QACAd,EAAKK,IAAMF,EAAIE,IAAMkB,EACrBvB,EAAK0B,SAAWxB,EAAIyB,IAAI,SAAUH,GAAM,GAAM,GAC9CxB,EAAKoB,KAAOlB,EAAIyB,IAAI,KAAMF,GAAO,GAAM,MAO1C,OAFAvB,EAAI,gBAAkBD,EAAKsC,MAAMvC,EAAMG,GAEhCA","file":"../../_base/window.js","sourcesContent":["define([\"./kernel\", \"./lang\", \"../sniff\"], function(dojo, lang, has){\r\n// module:\r\n//\t\tdojo/_base/window\r\n\r\nvar ret = {\r\n\t// summary:\r\n\t//\t\tAPI to save/set/restore the global/document scope.\r\n\r\n\tglobal: dojo.global,\r\n\t/*=====\r\n\t global: {\r\n\t\t // summary:\r\n\t\t //\t\tAlias for the current window. 'global' can be modified\r\n\t\t //\t\tfor temporary context shifting. See also withGlobal().\r\n\t\t // description:\r\n\t\t //\t\tUse this rather than referring to 'window' to ensure your code runs\r\n\t\t //\t\tcorrectly in managed contexts.\r\n\t },\r\n\t =====*/\r\n\r\n\tdoc: dojo.global[\"document\"] || null,\r\n\t/*=====\r\n\tdoc: {\r\n\t\t// summary:\r\n\t\t//\t\tAlias for the current document. 'doc' can be modified\r\n\t\t//\t\tfor temporary context shifting. See also withDoc().\r\n\t\t// description:\r\n\t\t//\t\tUse this rather than referring to 'window.document' to ensure your code runs\r\n\t\t//\t\tcorrectly in managed contexts.\r\n\t\t// example:\r\n\t\t//\t|\tn.appendChild(dojo.doc.createElement('div'));\r\n\t},\r\n\t=====*/\r\n\r\n\tbody: function(/*Document?*/ doc){\r\n\t\t// summary:\r\n\t\t//\t\tReturn the body element of the specified document or of dojo/_base/window::doc.\r\n\t\t// example:\r\n\t\t//\t|\twin.body().appendChild(dojo.doc.createElement('div'));\r\n\r\n\t\t// Note: document.body is not defined for a strict xhtml document\r\n\t\t// Would like to memoize this, but dojo.doc can change vi dojo.withDoc().\r\n\t\tdoc = doc || dojo.doc;\r\n\t\treturn doc.body || doc.getElementsByTagName(\"body\")[0]; // Node\r\n\t},\r\n\r\n\tsetContext: function(/*Object*/ globalObject, /*DocumentElement*/ globalDocument){\r\n\t\t// summary:\r\n\t\t//\t\tchanges the behavior of many core Dojo functions that deal with\r\n\t\t//\t\tnamespace and DOM lookup, changing them to work in a new global\r\n\t\t//\t\tcontext (e.g., an iframe). The varibles dojo.global and dojo.doc\r\n\t\t//\t\tare modified as a result of calling this function and the result of\r\n\t\t//\t\t`dojo.body()` likewise differs.\r\n\t\tdojo.global = ret.global = globalObject;\r\n\t\tdojo.doc = ret.doc = globalDocument;\r\n\t},\r\n\r\n\twithGlobal: function(\t/*Object*/ globalObject,\r\n\t\t\t\t\t\t\t/*Function*/ callback,\r\n\t\t\t\t\t\t\t/*Object?*/ thisObject,\r\n\t\t\t\t\t\t\t/*Array?*/ cbArguments){\r\n\t\t// summary:\r\n\t\t//\t\tInvoke callback with globalObject as dojo.global and\r\n\t\t//\t\tglobalObject.document as dojo.doc.\r\n\t\t// description:\r\n\t\t//\t\tInvoke callback with globalObject as dojo.global and\r\n\t\t//\t\tglobalObject.document as dojo.doc. If provided, globalObject\r\n\t\t//\t\twill be executed in the context of object thisObject\r\n\t\t//\t\tWhen callback() returns or throws an error, the dojo.global\r\n\t\t//\t\tand dojo.doc will be restored to its previous state.\r\n\r\n\t\tvar oldGlob = dojo.global;\r\n\t\ttry{\r\n\t\t\tdojo.global = ret.global = globalObject;\r\n\t\t\treturn ret.withDoc.call(null, globalObject.document, callback, thisObject, cbArguments);\r\n\t\t}finally{\r\n\t\t\tdojo.global = ret.global = oldGlob;\r\n\t\t}\r\n\t},\r\n\r\n\twithDoc: function(\t/*DocumentElement*/ documentObject,\r\n\t\t\t\t\t\t/*Function*/ callback,\r\n\t\t\t\t\t\t/*Object?*/ thisObject,\r\n\t\t\t\t\t\t/*Array?*/ cbArguments){\r\n\t\t// summary:\r\n\t\t//\t\tInvoke callback with documentObject as dojo/_base/window::doc.\r\n\t\t// description:\r\n\t\t//\t\tInvoke callback with documentObject as dojo/_base/window::doc. If provided,\r\n\t\t//\t\tcallback will be executed in the context of object thisObject\r\n\t\t//\t\tWhen callback() returns or throws an error, the dojo/_base/window::doc will\r\n\t\t//\t\tbe restored to its previous state.\r\n\r\n\t\tvar oldDoc = ret.doc,\r\n\t\t\toldQ = has(\"quirks\"),\r\n\t\t\toldIE = has(\"ie\"), isIE, mode, pwin;\r\n\r\n\t\ttry{\r\n\t\t\tdojo.doc = ret.doc = documentObject;\r\n\t\t\t// update dojo.isQuirks and the value of the has feature \"quirks\".\r\n\t\t\t// remove setting dojo.isQuirks and dojo.isIE for 2.0\r\n\t\t\tdojo.isQuirks = has.add(\"quirks\", dojo.doc.compatMode == \"BackCompat\", true, true); // no need to check for QuirksMode which was Opera 7 only\r\n\r\n\t\t\tif(has(\"ie\")){\r\n\t\t\t\tif((pwin = documentObject.parentWindow) && pwin.navigator){\r\n\t\t\t\t\t// re-run IE detection logic and update dojo.isIE / has(\"ie\")\r\n\t\t\t\t\t// (the only time parentWindow/navigator wouldn't exist is if we were not\r\n\t\t\t\t\t// passed an actual legitimate document object)\r\n\t\t\t\t\tisIE = parseFloat(pwin.navigator.appVersion.split(\"MSIE \")[1]) || undefined;\r\n\t\t\t\t\tmode = documentObject.documentMode;\r\n\t\t\t\t\tif(mode && mode != 5 && Math.floor(isIE) != mode){\r\n\t\t\t\t\t\tisIE = mode;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdojo.isIE = has.add(\"ie\", isIE, true, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(thisObject && typeof callback == \"string\"){\r\n\t\t\t\tcallback = thisObject[callback];\r\n\t\t\t}\r\n\r\n\t\t\treturn callback.apply(thisObject, cbArguments || []);\r\n\t\t}finally{\r\n\t\t\tdojo.doc = ret.doc = oldDoc;\r\n\t\t\tdojo.isQuirks = has.add(\"quirks\", oldQ, true, true);\r\n\t\t\tdojo.isIE = has.add(\"ie\", oldIE, true, true);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nhas(\"extend-dojo\") && lang.mixin(dojo, ret);\r\n\r\nreturn ret;\r\n\r\n});\r\n"]}